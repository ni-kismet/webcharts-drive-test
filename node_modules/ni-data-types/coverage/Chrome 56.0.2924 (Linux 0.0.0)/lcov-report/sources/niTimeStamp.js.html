<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for sources/niTimeStamp.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">sources/</a> niTimeStamp.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">96.67% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>58/60</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">90.91% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>20/22</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">88.89% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>8/9</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">96.67% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>58/60</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">50×</span>
<span class="cline-any cline-yes">50×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">50×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">23×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">5×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">9×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">//****************************************
// NITimestamp data type
// National Instruments Copyright 2016
//****************************************
&nbsp;
(function () {
    'use strict';
&nbsp;
    var MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER || <span class="branch-1 cbranch-no" title="branch not covered" >9007199254740991;</span>
    var epochDiffInSeconds = 2082844800; //the difference between JS epoch (1970) and LV Epoch (1904) in seconds.
    var JSEpochInSeconds = 62135596800;
&nbsp;
    /* A NITimestamp can be created with no param, and with different types of parameters:
         1. a string in the format '123:567890' where
             the first part is an INT64 serialized to a decimal string, representing the nr. of seconds realtive to LV Epoch
             the second part is a INT 64 reprezenting the fractional part
         2. a javascript Date
         3. a double number
         4. a NITimestamp
    */
    var NITimestamp = function (value) {
        var timeInMilliSeconds, timeInSeconds, remainder;
        this.epochDiffInSeconds = epochDiffInSeconds; // TODO verify it and make it private
&nbsp;
        if (typeof value === 'string') {
            var parts = value.split(':');
            this.seconds = Math.floor(parseFloat(parts[0]));
            var fractionalPart = parseFloat(parts[1]);
&nbsp;
            <span class="missing-if-branch" title="if path not taken" >I</span>if (fractionalPart &gt; 18446744073709550000) {
<span class="cstat-no" title="statement not covered" >                fractionalPart = 18446744073709550000;</span>
            }
&nbsp;
            this.fractions = Math.ceil(fractionalPart / 2048) / (MAX_SAFE_INTEGER + 1);
        } else if (value instanceof Date) {
            timeInMilliSeconds = value.getTime();
            timeInSeconds = Math.floor(timeInMilliSeconds / 1000);
            this.seconds = timeInSeconds + this.epochDiffInSeconds;
            // JS % operator returns negative result if divisor is negative. This makes it positive.
            remainder = ((timeInMilliSeconds % 1000) + 1000) % 1000;
            this.fractions = remainder / 1000;
        } else if (typeof value === 'number') {
            timeInSeconds = Math.floor(value);
            this.seconds = timeInSeconds;
            this.fractions = value - timeInSeconds;
        } else if (value instanceof NITimestamp) {
            /*copy the timestamp*/
            this.seconds = value.seconds;
            this.fractions = value.fractions;
        } else {
            this.seconds = 0.0;
            this.fractions = 0.0;
        }
    };
&nbsp;
    var proto = NITimestamp.prototype;
&nbsp;
    proto.toString = function () {
        return '' + Math.floor(this.seconds) + ':' + Math.round(this.fractions * (MAX_SAFE_INTEGER + 1) * 2048);
    };
&nbsp;
    proto.toJSON = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >        return this.toString();</span>
    };
&nbsp;
    proto.toDate = function () {
        return new Date((this.seconds - this.epochDiffInSeconds + this.fractions) * 1000);
    };
&nbsp;
    proto.valueOf = function () {
        return this.seconds + this.fractions;
    };
&nbsp;
    /*calculates the seconds passed since the Gregorian epoch for this timestamp*/
    proto.toAbsoluteTime = function () {
        return this.seconds + this.fractions + JSEpochInSeconds - epochDiffInSeconds;
    };
&nbsp;
    proto.compare = function (timestamp) {
        if (this.seconds &lt; timestamp.seconds) {
            return -1;
        } else if (this.seconds &gt; timestamp.seconds) {
            return 1;
        } else {
            if (this.fractions &lt; timestamp.fractions) {
                return -1;
            } else if (this.fractions &gt; timestamp.fractions) {
                return 1;
            } else {
                return 0;
            }
        }
    };
&nbsp;
    proto.add = function (dt) {
        this.seconds += Math.floor(dt);
        var fraction = dt - Math.floor(dt);
        fraction += this.fractions;
        if (fraction &gt;= 1) {
            fraction -= 1;
            this.seconds += 1;
        }
&nbsp;
        this.fractions = fraction;
&nbsp;
        return this; //enable chaining
    };
&nbsp;
    window.NITimestamp = NITimestamp;
}());
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Feb 21 2017 12:50:13 GMT+0000 (UTC)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
